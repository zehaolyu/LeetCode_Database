Leetcode Database


8/4
30 minutes

176. Second Highest Salary
How to deal with null value and remember to use distinct
Method 1: use select
Method 2: Max(Distinct Salary)
Limit 1 offset 1 could be limit 1,1
Code:
select
    (select distinct Salary from Employee
     order by Salary desc
     limit 1 offset 1) SecondHighestSalary


175. Combine Two Tables
Left join
Code:
select FirstName, LastName, City, State
from Person left join Address
on Person.PersonId = Address.PersonId


181. Employees Earning More Than Their Managers
The order of join?
Code:
select e1.Name Employee from
Employee e1 join Employee e2
on e1.ManagerId = e2.Id
where e1.Salary > e2.Salary


1179. Reformat Department Table
Case when and sum
Code:
select id,
sum(case when month = 'Jan' then revenue end) Jan_revenue,
sum(case when month = 'Feb' then revenue end) Feb_revenue,
sum(case when month = 'Mar' then revenue end) Mar_revenue,
sum(case when month = 'Apr' then revenue end) Apr_revenue,
sum(case when month = 'May' then revenue end) May_revenue,
sum(case when month = 'Jun' then revenue end) Jun_revenue,
sum(case when month = 'Jul' then revenue end) Jul_revenue,
sum(case when month = 'Aug' then revenue end) Aug_revenue,
sum(case when month = 'Sep' then revenue end) Sep_revenue,
sum(case when month = 'Oct' then revenue end) Oct_revenue,
sum(case when month = 'Nov' then revenue end) Nov_revenue,
sum(case when month = 'Dec' then revenue end) Dec_revenue
from Department
group by id


183. Customers Who Never Order
Code:
select Name Customers
from Customers
where Id not in (select CustomerId from Orders)


8/5

31 minutes

182. Duplicate Emails
Code:
select Email from Person
group by Email
having count(Email)>1

196. Delete Duplicate Emails
Use delete statement!
Code:
delete p1 from
Person p1,
Person p2
where p1.Email = p2.Email and p1.Id>p2.Id

197. Rising Temperature
DATEDIFF
Code:
select w2.Id Id
from
Weather w1,
Weather w2
where DATEDIFF(w2.RecordDate, w1.RecordDate) = 1 
and w1.Temperature < w2.Temperature

597. Friend Requests I: Overall Acceptance Rate
IFNULL
Code:
select
round(
    ifnull(
    (select count(*) from (select distinct requester_id, accepter_id from request_accepted) as A)
    /
    (select count(*) from (select distinct sender_id, send_to_id from friend_request) as B),
    0)
, 2) as accept_rate;

603. Consecutive Available Seats
Code:
select distinct c2.seat_id
from
cinema c1,
cinema c2,
cinema c3
where (c1.seat_id = c2.seat_id-1 and c1.free = 1 and c2.free=1)
or (c3.seat_id = c2.seat_id+1 and c3.free = 1 and c2.free=1)
order by seat_id
